# Figma Plugin Workflow Integration

This guide shows how to use the P2 Sim Design Generator plugin from your P2 Sim workflows with **full automation support**.

## üöÄ Quick Start

### Step 1: Add Figma Block to Workflow

1. Open your P2 Sim workflow editor
2. Add a **Figma** block to your workflow
3. Select **"Invoke Plugin"** as the operation

### Step 2: Configure Parameters

Fill in the required parameters:

- **Design Prompt**: Describe what you want to create
  - Example: "Create a modern landing page for a SaaS product with hero section, features, and pricing"
  
- **Design Type**: Choose from:
  - `landing_page` - Complete landing page layouts
  - `component` - Reusable UI components
  - `wireframe` - Low-fidelity wireframes
  - `generic` - Custom designs

- **Brand Guidelines** (Optional): Add brand colors, fonts, etc.
  - Example: "Blue and white color scheme, Inter font, modern design"

- **Responsive Breakpoints** (Optional): Select target devices
  - Mobile, Tablet, Desktop

- **Export Format** (Optional): Choose output format
  - PNG, JPG, SVG, PDF

- **Include Code Output** (Optional): Generate HTML/CSS/React code

### Step 3: Enable Full Automation (NEW!)

**üÜï Automatic Design Generation**: Enable these options for zero human intervention:

- **Auto Generate Design**: ‚úÖ Automatically creates the design without opening Figma
- **Auto Export**: ‚úÖ Automatically exports the generated design
- **File Name**: Name for the automatically created Figma file
- **File Description**: Description for the file
- **Project ID**: Figma project where the file will be created
- **Team ID**: Figma team (optional)

### Step 4: Run the Workflow

**With Auto-Generate Enabled:**
1. Execute your workflow
2. ‚úÖ Figma file is created automatically
3. ‚úÖ Design is generated automatically
4. ‚úÖ Export is completed automatically
5. ‚úÖ **Direct Figma file URL provided** - click to access your design immediately
6. ‚úÖ All files are ready for immediate use

**Without Auto-Generate (Manual):**
1. Execute your workflow
2. The tool will generate plugin invocation data
3. Follow the provided instructions to use the plugin in Figma

## üìã Workflow Output

The workflow will provide different outputs based on whether auto-generation is enabled:

### With Auto-Generate Enabled ‚úÖ

**File Creation Data:**
```json
{
  "fileCreation": {
    "success": true,
    "fileKey": "abc123def456",
    "fileName": "AI Generated Design - 2024-01-15",
    "fileUrl": "https://www.figma.com/file/abc123def456",
    "projectId": "proj_123456",
    "teamId": "team_789012"
  }
}
```

**Plugin Execution Results:**
```json
{
  "pluginInvocation": {
    "status": "success",
    "message": "Design generated automatically without human intervention",
    "generatedFrameId": "frame_1705123456789",
    "elementCount": 15,
    "autoGenerated": true,
    "exportData": {
      "format": "PNG",
      "data": "base64_encoded_image_data",
      "size": 1048576,
      "metadata": {...},
      "timestamp": "2024-01-15T10:30:00Z"
    }
  }
}
```

### Without Auto-Generate (Manual)

**Plugin Invocation Data:**
```json
{
  "designPrompt": "Your design description",
  "designType": "landing_page",
  "brandGuidelines": "Your brand guidelines",
  "responsiveBreakpoints": ["mobile", "tablet", "desktop"],
  "exportFormat": "PNG",
  "includeCode": true
}
```

### Design Specifications
- Complete design requirements
- Brand integration details
- Responsive breakpoint specifications

### Code Output (if requested)
- HTML structure
- CSS styles
- React components
- Figma specifications

## üîß Using the Plugin in Figma

After running the workflow:

1. **Open Figma** with edit permissions
2. **Launch the plugin**: Plugins ‚Üí P2 Sim Design Generator
3. **Copy the design prompt** from the workflow output
4. **Configure options** using the provided data
5. **Generate your design**
6. **Export** using the specified format

## üìù Example Workflow

### Input Parameters
```yaml
Design Prompt: "Create a user dashboard with sidebar navigation, main content area, and data visualization widgets"
Design Type: "component"
Brand Guidelines: "Dark theme, blue accents, clean typography"
Responsive Breakpoints: ["desktop", "tablet"]
Export Format: "PNG"
Include Code Output: true
```

### Expected Output
- Plugin invocation data with all parameters
- HTML/CSS/React code for the dashboard
- Step-by-step instructions for Figma usage
- Design specifications for implementation

## üéØ Best Practices

### Design Prompts
- Be specific about layout and components
- Include target audience and use case
- Mention any specific requirements

### Brand Guidelines
- Include color codes (#hex values)
- Specify font families
- Describe design style (modern, minimal, etc.)

### Workflow Integration
- Use variables for dynamic prompts
- Connect with other tools for data-driven designs
- Store generated code in your codebase

## üîç Troubleshooting

### Common Issues

1. **"Tool not found" error**
   - Restart the development server
   - Check tool registration in registry.ts

2. **"Design Prompt is required" error**
   - Ensure all required parameters are filled
   - Check parameter mapping in figma.ts

3. **Read-only mode error in Figma**
   - Open a file with edit permissions
   - Create a new file if needed

4. **Plugin not appearing in Figma**
   - Check plugin installation
   - Verify manifest.json configuration

## üìö Advanced Usage

### Dynamic Prompts
Use workflow variables to create dynamic design prompts:

```javascript
// In your workflow
const prompt = `Create a ${productType} landing page for ${targetAudience} with ${keyFeatures}`
```

### Brand Integration
Connect with brand management tools:

```javascript
// Fetch brand guidelines from your system
const brandGuidelines = await getBrandGuidelines(companyId)
```

### Code Generation
Automatically commit generated code:

```javascript
// After plugin invocation
const codeOutput = workflowOutput.codeOutput
await commitToRepository(codeOutput.html, codeOutput.css)
```

## üöÄ Next Steps

1. **Test the integration** with simple prompts
2. **Create reusable workflows** for common design patterns
3. **Integrate with your design system** for consistent outputs
4. **Set up automated code generation** for your development workflow

---

**Need help?** Check the plugin documentation or contact support.
